<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€å•ç®¡ç†åå° - MG Portfolio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 30px;
            color: #333;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 4px;
        }
        
        .section-title {
            font-size: 20px;
            margin-bottom: 20px;
            color: #333;
            padding-bottom: 10px;
            border-bottom: 2px solid #333;
        }
        
        .work-item {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #ddd;
            border-radius: 4px;
        }
        
        .work-item.expanded {
            border-color: #333;
        }
        
        .work-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .work-title {
            font-weight: bold;
            font-size: 16px;
            color: #333;
        }
        
        .work-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: 2px solid #333;
            background: white;
            color: #333;
            cursor: pointer;
            border-radius: 4px;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .btn:hover {
            background: #333;
            color: white;
        }
        
        .btn-danger {
            border-color: #ff3333;
            color: #ff3333;
        }
        
        .btn-danger:hover {
            background: #ff3333;
            color: white;
        }
        
        .btn-primary {
            background: #333;
            color: white;
        }
        
        .btn-primary:hover {
            background: #555;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #333;
        }
        
        .work-form {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
        }
        
        .work-item.expanded .work-form {
            display: block;
        }
        
        .add-work-btn {
            margin-bottom: 20px;
        }
        
        .export-section {
            margin-top: 40px;
            padding: 20px;
            background: #e8f4f8;
            border-radius: 4px;
        }
        
        .export-section textarea {
            width: 100%;
            min-height: 200px;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        
        .info-box {
            background: #fff3cd;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
        }
        
        .info-box p {
            margin: 5px 0;
            font-size: 14px;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ MG Portfolio ç®€å•ç®¡ç†åå°</h1>
        
        <div class="info-box">
            <p><strong>âš ï¸ ä½¿ç”¨è¯´æ˜ï¼š</strong></p>
            <p>1. åœ¨ä¸‹æ–¹ç¼–è¾‘ä½œå“æ•°æ®</p>
            <p>2. ç‚¹å‡» "å¯¼å‡º JSON" æŒ‰é’®å¤åˆ¶ JSON æ•°æ®</p>
            <p>3. æ‰‹åŠ¨æ›´æ–° <code>_data/works.json</code> æ–‡ä»¶</p>
            <p>4. ä½¿ç”¨ Git æäº¤å¹¶æ¨é€åˆ° GitHub</p>
            <p>5. ç­‰å¾… GitHub Pages è‡ªåŠ¨æ›´æ–°ï¼ˆ1-2åˆ†é’Ÿï¼‰</p>
        </div>
        
        <div class="section">
            <h2 class="section-title">ä½œå“ç®¡ç†</h2>
            <button class="btn btn-primary add-work-btn" onclick="addNewWork()">+ æ·»åŠ æ–°ä½œå“</button>
            <div id="works-list"></div>
        </div>
        
        <div class="export-section">
            <h2 class="section-title">å¯¼å‡ºæ•°æ®</h2>
            <button class="btn btn-primary" onclick="exportJSON()">å¯¼å‡º JSON</button>
            <button class="btn" onclick="importJSON()">å¯¼å…¥ JSON</button>
            <textarea id="json-output" readonly placeholder="JSON æ•°æ®å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
            <p style="margin-top: 10px; font-size: 12px; color: #666;">
                å¤åˆ¶ä¸Šé¢çš„ JSON æ•°æ®ï¼Œæ›¿æ¢ <code>_data/works.json</code> æ–‡ä»¶çš„å†…å®¹
            </p>
        </div>
    </div>
    
    <script>
        // åŠ è½½ä½œå“æ•°æ®
        let works = [];
        
        async function loadWorks() {
            try {
                const response = await fetch('./_data/works.json');
                if (!response.ok) throw new Error('æ— æ³•åŠ è½½æ•°æ®');
                const data = await response.json();
                works = data.works || [];
                renderWorks();
            } catch (error) {
                console.error('åŠ è½½å¤±è´¥:', error);
                works = [];
                renderWorks();
            }
        }
        
        // æ¸²æŸ“ä½œå“åˆ—è¡¨
        function renderWorks() {
            const list = document.getElementById('works-list');
            list.innerHTML = '';
            
            works.forEach((work, index) => {
                const item = document.createElement('div');
                item.className = 'work-item';
                item.innerHTML = `
                    <div class="work-header" onclick="toggleWork(${index})">
                        <span class="work-title">${work.title || 'æœªå‘½åä½œå“'}</span>
                        <div class="work-actions" onclick="event.stopPropagation();">
                            <button class="btn" onclick="toggleWork(${index})">ç¼–è¾‘</button>
                            <button class="btn btn-danger" onclick="deleteWork(${index})">åˆ é™¤</button>
                        </div>
                    </div>
                    <div class="work-form">
                        <div class="form-group">
                            <label>ID</label>
                            <input type="number" id="id-${index}" value="${work.id || index + 1}">
                        </div>
                        <div class="form-group">
                            <label>æ ‡é¢˜</label>
                            <input type="text" id="title-${index}" value="${work.title || ''}">
                        </div>
                        <div class="form-group">
                            <label>æè¿°</label>
                            <input type="text" id="desc-${index}" value="${work.desc || ''}">
                        </div>
                        <div class="form-group">
                            <label>ç±»å‹</label>
                            <select id="type-${index}">
                                <option value="video" ${work.type === 'video' ? 'selected' : ''}>è§†é¢‘</option>
                                <option value="image" ${work.type === 'image' ? 'selected' : ''}>å›¾ç‰‡</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>æ–‡ä»¶å</label>
                            <input type="text" id="file-${index}" value="${work.file || ''}" placeholder="assetsæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶å">
                        </div>
                        <div class="form-group">
                            <label>åˆ†ç±»</label>
                            <select id="category-${index}">
                                <option value="åŠ¨ç”»" ${work.category === 'åŠ¨ç”»' ? 'selected' : ''}>åŠ¨ç”»</option>
                                <option value="ç»˜ç”»" ${work.category === 'ç»˜ç”»' ? 'selected' : ''}>ç»˜ç”»</option>
                                <option value="äº¤äº’" ${work.category === 'äº¤äº’' ? 'selected' : ''}>äº¤äº’</option>
                                <option value="è®¾è®¡" ${work.category === 'è®¾è®¡' ? 'selected' : ''}>è®¾è®¡</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>é“¾æ¥ï¼ˆå¯é€‰ï¼‰</label>
                            <input type="text" id="link-${index}" value="${work.link || ''}">
                        </div>
                        <div class="form-group">
                            <label>æ’åº</label>
                            <input type="number" id="order-${index}" value="${work.order || index + 1}">
                        </div>
                        <button class="btn btn-primary" onclick="saveWork(${index})">ä¿å­˜</button>
                    </div>
                `;
                list.appendChild(item);
            });
        }
        
        // åˆ‡æ¢ä½œå“ç¼–è¾‘çŠ¶æ€
        function toggleWork(index) {
            const items = document.querySelectorAll('.work-item');
            items.forEach((item, i) => {
                if (i === index) {
                    item.classList.toggle('expanded');
                } else {
                    item.classList.remove('expanded');
                }
            });
        }
        
        // ä¿å­˜ä½œå“
        function saveWork(index) {
            works[index] = {
                id: parseInt(document.getElementById(`id-${index}`).value) || index + 1,
                title: document.getElementById(`title-${index}`).value,
                desc: document.getElementById(`desc-${index}`).value,
                type: document.getElementById(`type-${index}`).value,
                file: document.getElementById(`file-${index}`).value,
                category: document.getElementById(`category-${index}`).value,
                link: document.getElementById(`link-${index}`).value,
                order: parseInt(document.getElementById(`order-${index}`).value) || index + 1
            };
            // æŒ‰orderæ’åº
            works.sort((a, b) => (a.order || 0) - (b.order || 0));
            renderWorks();
            exportJSON();
        }
        
        // åˆ é™¤ä½œå“
        function deleteWork(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä½œå“å—ï¼Ÿ')) {
                works.splice(index, 1);
                renderWorks();
                exportJSON();
            }
        }
        
        // æ·»åŠ æ–°ä½œå“
        function addNewWork() {
            const newWork = {
                id: works.length + 1,
                title: 'æ–°ä½œå“',
                desc: 'ä½œå“æè¿°',
                type: 'video',
                file: '',
                category: 'åŠ¨ç”»',
                link: '',
                order: works.length + 1
            };
            works.push(newWork);
            renderWorks();
            // å±•å¼€æœ€åä¸€ä¸ª
            setTimeout(() => {
                const items = document.querySelectorAll('.work-item');
                if (items.length > 0) {
                    items[items.length - 1].classList.add('expanded');
                }
            }, 100);
            exportJSON();
        }
        
        // å¯¼å‡ºJSON
        function exportJSON() {
            const output = {
                works: works
            };
            document.getElementById('json-output').value = JSON.stringify(output, null, 2);
        }
        
        // å¯¼å…¥JSON
        function importJSON() {
            const json = prompt('ç²˜è´´ JSON æ•°æ®ï¼š');
            if (json) {
                try {
                    const data = JSON.parse(json);
                    works = data.works || [];
                    renderWorks();
                    exportJSON();
                    alert('å¯¼å…¥æˆåŠŸï¼');
                } catch (error) {
                    alert('JSON æ ¼å¼é”™è¯¯ï¼š' + error.message);
                }
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶åŠ è½½æ•°æ®
        loadWorks();
    </script>
</body>
</html>

